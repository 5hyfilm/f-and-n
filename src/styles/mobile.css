/* Path: src/styles/mobile.css */

/* ✅ Safe Area Variables - กำหนด CSS custom properties */
:root {
    --safe-area-inset-top: env(safe-area-inset-top, 0px);
    --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
    --safe-area-inset-left: env(safe-area-inset-left, 0px);
    --safe-area-inset-right: env(safe-area-inset-right, 0px);

    /* ✅ App-specific safe area values */
    --app-safe-top: max(var(--safe-area-inset-top), 20px);
    --app-safe-bottom: max(var(--safe-area-inset-bottom), 20px);
}

/* ✅ Base Mobile Layout */
.mobile-viewport {
    min-height: 100vh;
    min-height: 100dvh;
    /* Dynamic viewport height */
    min-height: 100svh;
    /* Small viewport height */

    /* ✅ รองรับ safe area ใน viewport */
    min-height: calc(100vh - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
}

/* ✅ Fixed Safe Area Classes */
.safe-area-top {
    padding-top: var(--app-safe-top);
}

.safe-area-bottom {
    padding-bottom: var(--app-safe-bottom);
}

.safe-area-left {
    padding-left: var(--safe-area-inset-left);
}

.safe-area-right {
    padding-right: var(--safe-area-inset-right);
}

.safe-area-all {
    padding-top: var(--app-safe-top);
    padding-bottom: var(--app-safe-bottom);
    padding-left: var(--safe-area-inset-left);
    padding-right: var(--safe-area-inset-right);
}

/* ✅ PWA Status Bar Compatibility */
.pwa-container {
    /* ✅ ไม่ให้ content ทับ status bar */
    margin-top: var(--safe-area-inset-top);
    margin-left: var(--safe-area-inset-left);
    margin-right: var(--safe-area-inset-right);
    /* ไม่ใส่ margin-bottom เพื่อให้ content ใช้พื้นที่เต็ม */
}

/* ✅ Header ที่รองรับ Safe Area */
.mobile-header {
    @apply px-3 py-2;

    /* ✅ เพิ่ม safe area support */
    padding-top: calc(0.5rem + var(--safe-area-inset-top));
    padding-left: calc(0.75rem + var(--safe-area-inset-left));
    padding-right: calc(0.75rem + var(--safe-area-inset-right));
}

.desktop-header {
    @apply px-6 py-4;
}

/* ✅ Fixed Navigation Bar */
.mobile-nav {
    @apply fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200;

    /* ✅ เพิ่ม safe area support สำหรับ navigation */
    padding-bottom: var(--app-safe-bottom);
    padding-left: var(--safe-area-inset-left);
    padding-right: var(--safe-area-inset-right);
}

.mobile-nav-item {
    @apply flex-1 flex flex-col items-center justify-center py-2 text-xs;
}

/* ✅ Full Screen Camera Mode - ปรับปรุงใหม่ */
.camera-fullscreen {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100vw;
    height: 100vh;
    height: 100dvh;
    /* Dynamic viewport height */
    background: #000;
    z-index: 1000;

    /* ✅ ไม่ใส่ safe area padding ใน camera mode เพื่อให้เต็มจอ */
    /* แต่ให้ content ภายในจัดการ safe area เอง */
}

/* ✅ Camera Overlay Elements */
.camera-overlay-top {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    z-index: 60;

    /* ✅ เพิ่ม safe area สำหรับ overlay ด้านบน */
    padding-top: var(--safe-area-inset-top);
    padding-left: var(--safe-area-inset-left);
    padding-right: var(--safe-area-inset-right);
}

.camera-overlay-bottom {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 60;

    /* ✅ เพิ่ม safe area สำหรับ overlay ด้านล่าง */
    padding-bottom: var(--safe-area-inset-bottom);
    padding-left: var(--safe-area-inset-left);
    padding-right: var(--safe-area-inset-right);
}

/* ✅ Floating Controls in Camera */
.camera-controls-floating {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 80;
    padding: 1rem;

    /* ✅ รองรับ safe area */
    padding-bottom: calc(1rem + var(--safe-area-inset-bottom));
    padding-left: calc(1rem + var(--safe-area-inset-left));
    padding-right: calc(1rem + var(--safe-area-inset-right));

    background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent);
}

/* ✅ Status Indicators for Camera */
.camera-status-floating {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    z-index: 80;
    padding: 1rem;

    /* ✅ รองรับ safe area */
    padding-top: calc(1rem + var(--safe-area-inset-top));
    padding-left: calc(1rem + var(--safe-area-inset-left));
    padding-right: calc(1rem + var(--safe-area-inset-right));

    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.6), transparent);
}

/* ✅ Mobile Modal - ปรับปรุงใหม่ */
.mobile-modal {
    @apply fixed inset-0 z-50 flex items-end justify-center;

    /* ✅ รองรับ safe area */
    padding-left: var(--safe-area-inset-left);
    padding-right: var(--safe-area-inset-right);
    padding-bottom: var(--safe-area-inset-bottom);
}

@media (min-width: 768px) {
    .mobile-modal {
        @apply items-center;
        padding: 1rem;
    }
}

.mobile-modal-content {
    @apply w-full max-w-lg bg-white rounded-t-xl;

    /* ✅ กำหนดความสูงสูงสุดโดยคำนึงถึง safe area */
    max-height: calc(90vh - var(--safe-area-inset-bottom));
}

@media (min-width: 768px) {
    .mobile-modal-content {
        @apply rounded-xl max-w-md;
        max-height: 80vh;
    }
}

/* ✅ Compact Component Styles */
.compact-button {
    @apply p-2 rounded-md text-sm;

    /* ✅ Touch-friendly size */
    min-height: 44px;
    min-width: 44px;
}

.compact-icon {
    @apply w-4 h-4;
}

.compact-text {
    @apply text-xs;
}

/* ✅ Touch-friendly Button Sizes */
.touch-button {
    @apply min-h-[44px] min-w-[44px] flex items-center justify-center;

    /* ✅ เพิ่ม tap highlight */
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
    tap-highlight-color: rgba(0, 0, 0, 0.1);
}

/* ✅ Mobile Card Styles */
.mobile-card {
    @apply rounded-lg shadow-sm border border-gray-200 overflow-hidden;
}

.mobile-card-header {
    @apply px-3 py-2 bg-gray-50 border-b border-gray-200;
}

.mobile-card-content {
    @apply p-3;
}

/* ✅ Responsive Grid */
.mobile-grid {
    @apply grid grid-cols-1 gap-3;
}

@media (min-width: 640px) {
    .mobile-grid {
        @apply grid-cols-2 gap-4;
    }
}

@media (min-width: 1024px) {
    .mobile-grid {
        @apply grid-cols-3 gap-6;
    }
}

/* ✅ Mobile-specific Spacing */
.mobile-space-y {
    @apply space-y-3;
}

@media (min-width: 768px) {
    .mobile-space-y {
        @apply space-y-6;
    }
}

/* ✅ Hide/Show Elements */
.hidden-mobile {
    @apply hidden;
}

@media (min-width: 768px) {
    .hidden-mobile {
        @apply block;
    }
}

.mobile-only {
    @apply block;
}

@media (min-width: 768px) {
    .mobile-only {
        @apply hidden;
    }
}

/* ✅ Mobile Typography */
.mobile-title {
    @apply text-lg font-semibold;
}

@media (min-width: 768px) {
    .mobile-title {
        @apply text-xl;
    }
}

.mobile-subtitle {
    @apply text-sm text-gray-600;
}

@media (min-width: 768px) {
    .mobile-subtitle {
        @apply text-base;
    }
}

/* ✅ Mobile Form Styles */
.mobile-form-group {
    @apply space-y-1;
}

.mobile-input {
    @apply w-full px-3 py-2 border border-gray-300 rounded-lg text-base;

    /* ✅ ป้องกัน zoom ใน iOS */
    font-size: 16px;
}

.mobile-label {
    @apply text-sm font-medium text-gray-700;
}

/* ✅ Custom Scrollbar */
.custom-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: #d1d5db #f9fafb;
}

.custom-scrollbar::-webkit-scrollbar {
    width: 6px;
}

.custom-scrollbar::-webkit-scrollbar-track {
    background: #f9fafb;
    border-radius: 3px;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: #d1d5db;
    border-radius: 3px;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: #9ca3af;
}

/* ✅ Prevent Body Scroll during Full Screen */
.fullscreen-active {
    overflow: hidden;
    position: fixed;
    width: 100%;
    height: 100%;
}

/* ✅ iOS Safari Specific Fixes */
@supports (-webkit-touch-callout: none) {
    .mobile-viewport {
        /* ✅ Fix for iOS Safari viewport */
        min-height: -webkit-fill-available;
    }

    .camera-fullscreen {
        height: -webkit-fill-available;
    }
}

/* ✅ Android Chrome Specific Fixes */
@media screen and (max-width: 767px) {
    .mobile-viewport {
        /* ✅ Prevent horizontal scroll on mobile */
        overflow-x: hidden;
    }
}

/* ✅ High DPI Screen Support */
@media (-webkit-min-device-pixel-ratio: 2),
(min-resolution: 192dpi) {
    .mobile-card {
        border-width: 0.5px;
    }
}

/* ✅ Accessibility Improvements */
@media (prefers-reduced-motion: reduce) {
    * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* ✅ Dark Mode Support (ถ้าต้องการ) */
@media (prefers-color-scheme: dark) {
    .mobile-card {
        @apply bg-gray-800 border-gray-700;
    }

    .mobile-card-header {
        @apply bg-gray-700 border-gray-600;
    }
}